%html
  %head
    %title 8 Sections
    %link{rel: 'stylesheet', href: 'https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css', integrity: 'sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u', crossorigin: 'anonymous'}
    %link{rel: 'stylesheet', href: 'https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css', integrity: 'sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp', crossorigin: 'anonymous'}

    %link{rel: 'stylesheet', href: '/css/dashboard.css'}
    
    %link{rel: 'stylesheet', href: '//cdn.jsdelivr.net/chartist.js/latest/chartist.min.css'}
    
    %script{src: '//cdn.jsdelivr.net/chartist.js/latest/chartist.min.js'}
      
  %body
    
    %nav{class: 'navbar navbar-inverse navbar-fixed-top'}
      %div{class: 'container-fluid'}
        %div{class: 'navbar-header'}
          %a{class: 'navbar-brand', href: '/'}
            8 Sections
            
    %div{class: 'container-fluid'}
      %div{class: 'row'}
        
        %div{class: 'col-sm-3 col-md-2 sidebar'}
          %ul{class: 'nav nav-sidebar'} 
            %li
              %a{href: '/?districts=Lynn'}
                Lynn 
            %li
              %a{href: '/?districts=Lynnfield'}
                Lynnfield
            %li
              %a{href: '/?districts=Marblehead'}
                Marblehead
            %li
              %a{href: '/?districts=Salem'}
                Salem
            %li
              %a{href: '/?districts=Scituate'}
                Scituate
            %li
              %a{href: '/?districts=Swampscott'}
                Swampscott
                
        %div{class: 'col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main'}

          %form{method: 'GET', action: '/'}
            %div{class: 'form-group'}
              %select{name: 'districts'} 
                - @all_districts.each do |d|
                  %option{value: d.name, selected: params['districts'] == d.name}= d.name

            %div{class: 'form-group'}
              - @all_grades.each do |g|
                %label{class: 'checkbox-inline'}
                  %input{name: g.name, type: 'checkbox', checked: !params[g.name].nil?}
                  = g.name

            %div{class: 'form-group'}
              %button{type: 'submit'}= 'Submit'

          %div{class: 'ct-chart ct-golden-section', id: 'chart1'}
            %script
              new Chartist.Line('#chart1', {
              labels: [#{@years.collect{|y| y.year}.join(",")}],
              series: [
              - @series.each do |series|
                = "[#{series.collect{|s| s[0]}.join(',')}],"
              ]
              }, {
              lineSmooth: Chartist.Interpolation.none({
              fillHoles: false
              }),
              axisY: {
              high: #{@high},
              low: 0
              }});

          %h3{class: 'sub-header'}
            Raw Data

          %div{class: 'table-responsive'}   
            %table{class: 'table table-striped'}   
              %thead
                %th
                - @years.each do |year|
                  %th
                    #{year.year}

              %tbody
                - @series.each do |series|
                  %tr
                    %td
                      = series[0]
                    - series.each do |s|
                      %td= s[0]
                        
          Source
          
          %a{href: 'http://www.doe.mass.edu/infoservices/reports/enroll/'}
            Mass DESE Enrollment Data         
                   
          %h3{class: 'sub-header'}
            Author

          %div
            Terry Lorber<br/>
            Swampscott, MA<br/> 
            %em tgl (at) rideside (dot) net<br/>
            <br/>            
            2019-06-13

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-116554956-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-116554956-1');
    </script>
